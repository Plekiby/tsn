<!doctype html>
<html>
  <body>
    <h2>Groups</h2>

    <div style="margin-bottom:10px;">
      <a href="/posts/feed">Feed</a> |
      <a href="/users/all">Users</a> |
      <a href="/friends">Friends</a> |
      <a href="/notifications">Notifications</a>
    </div>

    <form method="POST" action="/auth/logout">
      <button type="submit">Logout</button>
    </form>

    <hr />

    <h3>Créer un groupe</h3>
    <form method="POST" action="/groups">
      <input name="name" placeholder="Nom du groupe" style="width:320px;" />
      <br /><br />
      <textarea name="description" rows="3" placeholder="Description (optionnel)" style="width:320px;"></textarea>
      <br /><br />
      <button type="submit">Créer</button>
    </form>

    <hr />

    <h3>Mes groupes</h3>
    <% if (!myMemberships || myMemberships.length === 0) { %>
      <p>Tu n’es membre d’aucun groupe.</p>
    <% } else { %>
      <ul>
        <% myMemberships.forEach(m => { %>
          <li>
            <a href="/groups/<%= m.group.id %>"><%= m.group.name %></a>
          </li>
        <% }) %>
      </ul>
    <% } %>

    <hr />

    <h3>Tous les groupes</h3>
    <% if (!groups || groups.length === 0) { %>
      <p>Aucun groupe.</p>
    <% } else { %>
      <% groups.forEach(g => { %>
        <div style="border:1px solid #ddd; padding:10px; margin:10px 0;">
          <div>
            <a href="/groups/<%= g.id %>"><strong><%= g.name %></strong></a>
          </div>

          <% if (g.description) { %>
            <div style="margin-top:6px;"><%= g.description %></div>
          <% } %>

          <div style="font-size:12px; opacity:0.7; margin-top:6px;">
            owner: <%= g.owner.displayName %> • members: <%= g._count.members %>
          </div>
        </div>
      <% }) %>
    <% } %>
  </body>
</html>
