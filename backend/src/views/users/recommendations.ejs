<!doctype html>
<html>
  <body>
    <h2>Recommandations FOAF + intérêts</h2>

    <div style="margin-bottom:10px;">
      <a href="/posts/feed">← Feed</a> |
      <a href="/users/all">All users</a> |
      <a href="/interests">Mes intérêts</a>
    </div>

    <form method="POST" action="/auth/logout" style="margin:10px 0;">
      <button type="submit">Logout</button>
    </form>

    <hr />

    <% if (!reco || reco.length === 0) { %>
      <p>Aucune reco pour l’instant.</p>
      <p>Pour en générer :</p>
      <ol>
        <li>Follow quelqu’un (A → B)</li>
        <li>Connecte-toi en B et follow quelqu’un d’autre (B → C)</li>
        <li>Reviens en A et recharge cette page</li>
      </ol>
    <% } %>

    <% (reco || []).forEach(u => { %>
      <div style="border:1px solid #ddd; padding:12px; margin:12px 0;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <strong style="font-size:18px;"><%= u.displayName %></strong>
          <form method="POST" action="/users/<%= u.id %>/follow">
            <button type="submit">Follow / Unfollow</button>
          </form>
        </div>

        <div style="margin-top:8px;">
          <div><b>Score</b> : <%= u.score %></div>
          <div><b>Mutuals</b> : <%= u.mutuals %>
            <% if (u.mutualNames && u.mutualNames.length) { %>
              — (<%= u.mutualNames.join(", ") %>)
            <% } %>
          </div>
          <div><b>Jaccard intérêts</b> : <%= u.jaccard %></div>

          <% if (u.commonInterests && u.commonInterests.length) { %>
            <div><b>Intérêts en commun</b> : <%= u.commonInterests.join(", ") %></div>
          <% } else { %>
            <div><i>Pas d’intérêt en commun détecté</i></div>
          <% } %>
        </div>
      </div>
    <% }) %>
  </body>
</html>
