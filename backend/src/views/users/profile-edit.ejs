<!doctype html>
<html>
  <body>
    <%- include("../partials/topnav", { unreadCount }) %>
    <h2>Éditer mon profil</h2>

    <div style="margin-bottom:10px;">
      <a href="/profiles/<%= profile.id %>">&larr; Retour au profil</a>
    </div>

    <hr />

    <form method="POST" action="/profiles/<%= profile.id %>/edit" enctype="multipart/form-data">
      <div style="margin-bottom:15px;">
        <label for="displayName">Nom affiché *</label><br />
        <input
          type="text"
          id="displayName"
          name="displayName"
          value="<%= profile.displayName || '' %>"
          required
          style="width:100%; max-width:400px; padding:8px;"
        />
      </div>

      <div style="margin-bottom:15px;">
        <label for="bio">Bio</label><br />
        <textarea
          id="bio"
          name="bio"
          rows="4"
          maxlength="500"
          placeholder="Parlez de vous..."
          style="width:100%; max-width:400px; padding:8px;"
        ><%= profile.bio || '' %></textarea>
        <div style="font-size:12px; opacity:0.7;">Max 500 caractères</div>
      </div>

      <div style="margin-bottom:15px;">
        <label for="location">Localisation</label><br />
        <input
          type="text"
          id="location"
          name="location"
          value="<%= profile.location || '' %>"
          maxlength="100"
          placeholder="Ville, Pays"
          style="width:100%; max-width:400px; padding:8px;"
        />
      </div>

      <div style="margin-bottom:15px;">
        <label for="website">Site web</label><br />
        <input
          type="url"
          id="website"
          name="website"
          value="<%= profile.website || '' %>"
          maxlength="200"
          placeholder="https://example.com"
          style="width:100%; max-width:400px; padding:8px;"
        />
      </div>

      <div style="margin-bottom:15px;">
        <label for="dateOfBirth">Date de naissance</label><br />
        <input
          type="date"
          id="dateOfBirth"
          name="dateOfBirth"
          value="<%= profile.dateOfBirth ? new Date(profile.dateOfBirth).toISOString().split('T')[0] : '' %>"
          style="padding:8px;"
        />
      </div>

      <div style="margin-bottom:15px;">
        <label>Avatar actuel</label><br />
        <% if (profile.avatar) { %>
          <img src="<%= profile.avatar %>" alt="Avatar" style="width:100px; height:100px; object-fit:cover; border-radius:50%; margin-top:8px;" />
        <% } else { %>
          <div style="width:100px; height:100px; border-radius:50%; background:#ddd; display:flex; align-items:center; justify-content:center; margin-top:8px;">
            Aucun
          </div>
        <% } %>
        <br />
        <label for="avatar" style="margin-top:8px; display:inline-block;">Nouveau avatar (max 5MB)</label><br />
        <input
          type="file"
          id="avatar"
          name="avatar"
          accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
          style="margin-top:4px;"
        />
      </div>

      <div style="margin-bottom:15px;">
        <label>Bannière actuelle</label><br />
        <% if (profile.banner) { %>
          <img src="<%= profile.banner %>" alt="Banner" style="width:100%; max-width:400px; height:120px; object-fit:cover; margin-top:8px;" />
        <% } else { %>
          <div style="width:100%; max-width:400px; height:120px; background:#ddd; display:flex; align-items:center; justify-content:center; margin-top:8px;">
            Aucune bannière
          </div>
        <% } %>
        <br />
        <label for="banner" style="margin-top:8px; display:inline-block;">Nouvelle bannière (max 5MB)</label><br />
        <input
          type="file"
          id="banner"
          name="banner"
          accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
          style="margin-top:4px;"
        />
      </div>

      <div style="margin-top:20px;">
        <button type="submit" style="padding:10px 20px; font-size:16px;">Enregistrer</button>
        <a href="/profiles/<%= profile.id %>" style="margin-left:10px;">Annuler</a>
      </div>
    </form>
  </body>
</html>
